require 'sinatra'
require 'sinatra/reloader'
require 'active_record'

ActiveRecord::Base.establish_connection(
  adapter:  "mysql2",
  host:     "localhost",
  username: "root",
  password: "",
  database: "training",
)

# CREATE TABLE posts (id INTEGER NOT NULL AUTO_INCREMENT,post_text TEXT,PRIMARY KEY (id));
# ALTER TABLE posts ADD (gender CHAR(1),pref TEXT )

class Post < ActiveRecord::Base
end



ActiveRecord::Base.logger = Logger.new(STDOUT)


get '/' do
  erb :index
end

post '/form' do
  @post_name = params[:post_name]
  erb :form
end

get '/enter' do
  @texts = %w(北海道 青森県 岩手県 宮城県 秋田県 山形県 福島県 茨城県 栃木県 群馬県 埼玉県 千葉県 東京都 神奈川県 新潟県 山梨県 長野県 富山県 石川県 福井県 岐阜県 静岡県 愛知県 三重県 滋賀県 京都府 大阪府 兵庫県 奈良県 和歌山県 鳥取県 島根県 岡山県 広島県 山口県 徳島県 香川県 愛媛県 高知県 福岡県 佐賀県 長崎県 熊本県 大分県 宮崎県 鹿児島県 沖縄県)
  erb :enter
end


post '/enter' do
  Post.create(:post_text => params[:post_name],
  :gender => params[:gender],:pref => params[:pref])
  p Post.all
  redirect '/'
end

# curl --data-urlencode "post_name=けん" --data-urlencode "pref=広島県" --data-urlencode "gender=M" http://localhost:4567/enter
# curl http://localhost:4567/enter --data-urlencode "post_name=けん" --data-urlencode "pref=広島県" --data-urlencode "gender=M"
# 参考ページ
# http://wagavulin.hatenablog.com/entry/2015/10/18/060938
# http://qiita.com/ueokande/items/a580e9d9f17dbf82f382
# curl 'http://localhost:4567/enter' -H 'Accept-Encoding: gzip, deflate, sdch' -H 'Accept-Language: ja,en-US;q=0.8,en;q=0.6,es;q=0.4' -H 'Upgrade-Insecure-Requests: 1' -H 'User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36' -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8' -H 'Cache-Control: max-age=0' -H 'Cookie: PHPSESSID=djnfdufgu8sbik44j72qf2anu4; sails.sid=s%3AkzuB4Wjuc7jLrTTiM0jLc8Z9hd8deCxd.L%2Fi3i6d4l%2F2Bi4%2F7%2BczXTEmYjxqeLEpkCQgRj%2BDb5sk; lasturl=/1; connect.sid=s%3A9K3F%2Bgz0ccmgNJxKZOU5dwVc.6ZMl6T49nCx3tHU0Xz%2BSzwS6%2FO5XUoIP16uBg%2FErEIA; _sample_session=SUhOaU83dkdvQlorcnpQV1JBVk5YdWU2bTBpYktFYWJ1b05JTGZwa041QlVrbEZHdWsvYnExcnJaVWxRNm1OamY4emZTK2tMc0NUcGNFdUpmY1F0WnlKMFZRcDF4a0xDeFlTRE16TjRQdVU3SmVJRDRjV09uK1hjUkZ5R3Q4bFdUSFVSZUFNcVJnM0JOV0tyVjFGUFpBPT0tLVpFSVQwWXlONWdpVU90WGJpNkIwenc9PQ%3D%3D--d41f0cc3c2c82513ecae0979ed8378f53b838484; _login_session=UjkwTm51VkhWWkJEOTR1OGZJNmZJWFQ1QndLYmF4dG54bTQzYWhWYzdvOUQ3S2N1Sks0bWJLVTk3WC9jS0I5UXFqSlIrY2JzWlcxbm9xcGdobldTRGZJUnJTTjNpUmtWaHNkeGlDOXZJK1IzMjBWUFVsTmtaZHJEN0s3UHdPL1F2bVJvYXZXUm1rdnZJcE5mT2xNYkFBPT0tLUFnMnRDci80djZPZzFRU3Q5bGR0NlE9PQ%3D%3D--3ab8143dce40830839ccb01facc59f77ddbb1536; _login5_session=WFVCRTFpL1ZBSTFOaGQ3ME9rbE9RRDRpRmFDbVo5SFNaeWhuL1pCcnBSNGZUQTQ0bVZhUWlVN2NvalJiZjE0elRJYlVjdnNEMkdIZ0EzdHlTOThiQmp2TzBJMUNwalBiRGFQdzVDT1MvVExnNGNmQ2owRktacE5kdW52eWs0SEhRRHp6Nkl0L0lkTTFFNGNYdjAvTFlweDlaZ0QyNkhqR3pEaytFTnZKNFR4S2srdVNPR0pBT2tnYlIya0s5K0ZULS1PZHB3SUY3WFR6bjBpaER6UFByOHlBPT0%3D--489df27af61d825aae124d150e8173f35fcb751b; _login2_session=eWhyZ293KzUyQVF1UWlyUExyQWpWN09tdkljcWY0bUlXbDlzM0JDRXZ4T05zdWszYnhHeFZCTlppeW02bVk4TnJ6cTF4M3hFcnJsWXkxTXUxRzRkenVaczBMUWtPbmFLOXZUV2RaWEdMTHFjM01mTDk2ajFzTDVjY25ISzYvbXNyTklDbWZLWWRGOUFEWG55VFRFdHBNM09wZ2pJSUNWRXJaN3g1TzhhazVFOW1Cams3amVBcTk0czB2NDRSbjBuZnpZbjNvQkNhRWYwblFQZVJROFJoVG5CVllJTU5xbG94MXV6czFEUUxlcXlnOXJXNDFTRFRYMHZHU0JxY1ZXNmU4YXVObTRNMXdjc3Vnci9zcGdZM0dwZW03K1RrNDd4M3EyNlZWSEpPdVRwaTdzcTNaNjNQbk5Ha1hGOHhNTE0tLVRQR0lEemczaUs4eHJTeU5tdURHVkE9PQ%3D%3D--f2e6cf69ce7b238941b673a24023abc50107e223; _login3_session=RUZycElVeTFLYmtQZE5zRksrZEJ5cW5wSWVlM0ZNTW9id1NCdmxjTWVtOHV2UTdzNGVJTnhqZE5HSnd0YjFkUzY2T0hQMmJMNmQzUmpBdTZaeVFsbjVoY1V2TDVjbjdycXFwb2RQTS9mSGsvSXNyNFpXQk9ReC9NSHJOMWp3cGJ6Sy85dWtmL21yWExucXhZTG83bnJnPT0tLTR4MGEwS0l2WDFybnhTRFNSQjJZdEE9PQ%3D%3D--b7d8cd135306c1885b9f310bcbb9a04f24d2af62; _message-board_session=bEFaUFhRaE1hYnZpSFhxaUlmSHV5SlplTjNtdzdmZml0Mk1rK3VhSk9Ib1U4NGtWbnlXRnh1aHRyU2N6ekRzQXVBR0Z4dnhhMW9NNkZmUU9NYXFNSVlCVmNUNlRvY1ovNUtTWkhiYTBXSTFoQmYxL0ZkNDhyMmNsMkNmMzZ0RkN3d213cUoxclViYVgxVmFwOGY2RlpnPT0tLXVqaDVYQW1uZmJSbmROalhETmtqbmc9PQ%3D%3D--26ef2d029ce0652258abf82afd2195d6bd2338c5; _microposts_session=bnZHaWNWOC9hODh3SzRqMUYxMkFXMG5kcHNrSFdORXdRZWVpQjRDcElDYVJPT3FHNlVHMHJMRXNTT2lYUFJ5SERrMVNvdE5lVThsZCtnaUFMTlBFME15ZXpEYWR0clRJVXFCRTRjSWRmYStyNjNnWmhUT2JJaFFrYWlqc1pxRnJ5Z0lwTjhYNjhrbVVKb0hkMWViekYvTkduWWhhTzJsOWNwUE1vS0ZlVkNSTUlXMWQ3QkwxU3ROMEh0VGRzWTJOeTdFWG00cm9yOTdRd2VLa3E2QlBqVjlROVM5ellhSUo1Y25BRWIxbGRtQkJGOFU4NkI2WlVmZ3VqM0ZWSFc4Wi0tNXhEaXhteUNHQXAycmpoZUsyYlRKQT09--d4f4e9ab456b0a0008b2be1340a78747eb199079; _railbook_session=UWkwWGRadXcyZFA0bXVpSVBPL2lXdy84TEVXakNvaFpjTVBPQkM1RC9TVGZvSTBOTUVwVnZFT0Zoa1BuaE9GWTA3S001cCtGRUExZng1Y1lKcDdtMkFVRkJxK1FVRldJVUtpcVczSVRYTWRsckZzNDg3c3J0WWJRcGlackx4THQ0WXFMcGRNbFRsVjNhL3hHajF5M1BBPT0tLXI5bUwxeGVSQm82RlBJdEROWFgrWXc9PQ%3D%3D--5c512dc07e7b93d806e9aea85517cfd98276ba5f; _ch3_session=QThRSEVvaFZGMnJrZENNcnJNRFJ0M1cvSFQ1SU4wV0s0M3RxNGkxZjdLV3NmMU9qZXF6bmVRd1pMSlRHMGJ4QkJjakM0Y1dpY1UwUUhRK3VWa2xKYTFGMGdjbVBZbFZzSXdNU1pqYUM1cG1ZU2dOOVpvVnJaa0Urc1BvOWtndUsrcDQyUjdkc2VUVEJlSm9hak56VjFBPT0tLWZLeXl1UkRqKy92QlF0ejFCTms3SVE9PQ%3D%3D--c012084eedaaf1af99ed32e0c6c6ba96a99201d7; _asagao_session=UnE4OGVsM1hoY1ZUUHMzbHN4eEJ3NklWS3RxWEFyT0MyQi96NUFQc2JLc1E0enQyTElsaU5rSEN3eEZEM3FnWXV5aHdSU3ZXN1hWNFR2V1Nob2pIVEJod0JrcHlhcUREREYyVDVlLzJmUEoyT2NvV1RmZ2xkRlMwYWlETUpFSlM3TUtIV0tIVzFFTXk5STdJOFljSFV3PT0tLTJEMzY3dCthaUdzOXYyK25yRWVHQ1E9PQ%3D%3D--0de10f5e2a021806027364a9926a47d18236902f; _welcome_dj_session=TXlxNzl1aHI4Q0JZYThldFFqRHllRkJSMlo4djZSQ3hKQ2FtR2tqcks5RFJqb0dKeGp1QWh5NG9ReVpoSFVTTHFVd1Q4bVZzN3IzZWxUa1BzOFpUdEhpeGNwTm9MbXBBMXNwU0lyYWN2UThnVDYvdmpkcEwrNTA3SnB6dXdWZkx5WmNZNytJTUtnTlIwQjJiQ0VaczJ3PT0tLVgzazkrNUQwQXMrUXZKWnJTTFplb2c9PQ%3D%3D--9736db69d2204b1ae6257bc6f325ad5f0c227e94; _enka_session=NnNBTVJDVTkwTEtxSnhGM2h1UW1VMjdRQjZFVjlIdHlQb0xUZXdGYzRKaVBRSXZwbldmbkRaejZjZ1hpU2VFUWYySTkwQXVoeFlPbnordmJhNEs0cmVDWWY5LzRHR2UrdnNZVzVSK2UyTGRpbFdodDd6VWdFV3h1RmRCWXVYVkFSTkd4blI3QUNpR3IvVnZWQmJHdFZTVFN3by8veVB4WGdMT0p4ZDJBbDJTWkI4Uk81RTk5TWZiRDJ0YkhxUDRHMVlObkJ2b0RqUkRTNXJGbUJTMEdkdz09LS1CSU1OQ2dpc1IvYS83UGxMb3VHZ3hRPT0%3D--0cc7ecf31e93531ab904a9b50f658b79c934a5e5; _tazkiyah_mvp_session=b1dUaXNhSko1TUZieE42V1lDaFlyMGpIbzRjNGpVSVBnZjFuWitTRmlWem5vaXVHUDgySGdxSnZ5eG1zeW5Zc2g1bG9zY0lETU9VOUZ5YjYvdlIxRDB5WXg1MlA2K1AwaUhnZHVpMVJQQmo4UGNMbUExSUkxZzdmaVk1Q1hXUXF6MUJva1gyTzk5aWw1Rm1DV2VCWXhBPT0tLTdUUWxwT2tPdHg1dkV5bWV2K2wyUlE9PQ%3D%3D--1ac4db8975531f9e73ff6d94e91f864aba1102f4; _my_app_session=aEFuUnBNeSt4N0JPWlV4S2ZGR3Q3VDI0OEFrTDRBQzN3TVM0cFRiUDE2MGJtRG1FUm9jaHBtNXpPbFJ4cTltQmhTWEJ6S2FncUdGVGpyRFJ6YjBpZlgvS3NrSUYrRFNFbXFybkhKaW1ldnZ0bHNreURsSExDcGs1UmJaUERoYk9ITnFEeVI1YnEwSVM5U3VIM1p2ZitYOWhMZDdsY0tjM2xJUTNza3B6a1UvWmg3NmRNOWY3Q1FiRjFwT0lWVDVMSUVGYW1ldzVSU0VQNThVaWxweXZYdVVCSkd5ZDU1RzNqRWxCSysxYkNMTWFsU2RmNVl2SGdRUHpFREtqSEZRbVpGUEZqVlhSRElMYW44K2cxY2V5WlNlNHNZb0pXRGQvQlkyVXM1VVdPMU8vend5UWp0dHJMVlVnTDBRRnoxRGZUZ2RZSXZjWm1ERXdacW9VN0V0M3NLWEtCUXdGNU8xQ1kyKzVyY0xuU1dCUnRZb2llVXY5OHRrSE1HUFlEcXlNaEtKa21CNHVFNkJBN0xBeGp2bkNrQT09LS0rZWRyNSttSFRxb1cvM3NNRFYrcDVnPT0%3D--929d0140795d217b39bbc7a9437358f6a94d6915; _devise_test_session=a3poZ1dmRWxTaWNPUmIyeVI1TzFTckpkbEppdThtUHVvU3EvUDFyelo0Sk1lQkpJMEt1bmlaYWdxUnBZQ1MyRXh2WG9rV085MFh0eVllRFRzb1RXU1loQWl1MEdQNFJqZjM0cnZSd1N5M2UvbjBzY3JlSUgwaFZDbGdtaGgrKy9VUWYxTTRFYXpwVG5GUWRVUmptdEpnQTNXbUpycGhFM2oxRDlhbXY1OUxKeG1wc0I3NEZ5T1ZPV0FSYWdKK2EydE04UDU2UjBwQXFBaFVCYkZlbkUrblp2K2dLazE2a3RaOTI4eFhySUR5bElVRjZBRURmb2xrUVRjVTF4TElSMWZUY3pJb2NlVlMyc0lVNVF0andLNE5ya2dLWU1WQVdiT1IvUFAzZGN4MnVhd2lyRE5nWTRLOHBOcXd5ZEpoS0ljZzB6Ym5WV05raGZLbFA5bktoNS9DazVlTDcvZGVuQ2FnOVRBYVVPZ1NuSmNSbEhaRFFPa0hLUCtqdVJEVmg1RDEzTFRuNFVQVFVlejEyRWZ0YXFFNXF5V3lOcjQ0b3lwc3NtdFk0ZU10K0ZmcE1OeDZDK1ErK0hqRC9NTGxaS3NwdGtGbVEvNEJINVNGL0NDNlY5YS9rb2hVR2tIdkExT05Rb0dwY2lVUXR4YzVzbDNIbE94S0Z0RmUwSjBuQkRBOUs2Qytad0g3c0pWbmNHY0VHZU9CSlYvdnl2NWdLc1oxNFVibmtUcmg1S1grSS9IOVFVYnErTmRvOVFIZGJhQnNjOUNLNUN0U0srRW1oM3VMUm1NMlNWVHVqNWFsR0hWNmtUeXAzbVJheEI4NjhKR1MrLzdGSEk2TVNKNS9leUduVVdEd29sTEprS0UxOHRjczlGeDZNYlBxU1hRYjF1ajVYaGl1blZQWlNWNVB1azJrb3dlVlJ4TG41ZlloSmxvNE1CRExGRU1VNzJMNEVqUkdhNFBVa2hyU09vamIxZDVQWnNMY1pUeS90YmsyK00xL0YrVGhITUNiNkkzQXFhL25XdTNhMThKb21DOU8zcWFiQnpMUUpXNUlRRnRMKzd6eGZxT0h1bWZhdHFEVEpBbThQMXZBeFp3SG5GaGl1bzZBUXVYc2lBc1hJMGtncHBSSjg4Z1M2aEh6VCtCdUE1LzhPMGlneGNYdDZRcGxYdHYxTTBHaTVjTC83bnBFSy96NmNVcGtpakNZTUlHYU84WFZ3WnBBPT0tLUxSNGFYdytaNGk1WmZNeS9IV2Rkamc9PQ%3D%3D--8cb60b16989d004d5088051160d8befec7ee9fee; _devise_test2_session=cmszYnlLTEc2Vi91eVlmNjl5ZnNuWUtuaWlQVmNOYW9IaXdZRkRZZHJyY1E2bjhkcDE2VFdCSjRFVFdER1NBSUJscU1KRzduanBrcHlrcjAxYWo0RUE2Sm4vSW5qMGVIUVdiaUZQT0svMUFSTUE0ODV4c3l2MHVEdDJRSzNiOXNyWnYwNXJhZnRFSlhjRUlwdVYzSjE0Ym5VL3BucHhISzZTVTJHaGxtVFZLUTFweUJ5MGJSMUtZem84UVJ2QVgvWFl6QXNvOTJLTFdvQWlLQ3lqTk5BWmVWWlpjL3JqUmZlTDJ5V0VMc0Q2djQxalo4ZTJXRXJPRWxqOFBFWWlBUFd5QmVnMm51OCt0UFJyRnRDRXllZkNKaU00c2tUSVpDREhPeWNnV3V4RW93Z2Z1QlhEczkyTFpZNDcrd0d0NG45TzArbU9FdDRpU2VqdmlJUWQxNHVIUHArSTVSUEtSTHczWk1HOUhpWlhMUExJMWJrOVAvaUNRLzJNdHhYZW1NajJOb0hWMU1menc1eERWTVZmVmdFWHFxVm94VWNrYSsvTS84K0R5L3FwbzFSaFUxMEVMWjdTc3U5WHl6dWxFNDZIbVVZZXBCNENhRy9Jd080QVlqaktZUEFXOGZYbjQ5RTdtRC9FTnBYODVGdlIva0tzemoyZ0Y5NllOQzZBRFlVK3J1blRpT084bzBMUUNwQ2ZBKzVQWkQ2UVhNRnRVRTRtNlFub1kzeWpmQVptRFgyVlNOYksrZEdteHBvQ3h1M2ZnMFh4Y3ExZXQzOGJZdE1ZRnM1MW40b2JzMkVKS0Znayt0M2ZlUDRoND0tLTN6dDhIeGxBdnJ2WkxpRkZldERlZlE9PQ%3D%3D--da216ea47826bc15db0a1b1a821101301ec8d1d9; _awesome_events_session=ejdmbDVzUlBsNnY5N1JlL2lVOG5hdDJWeEJPa05YUWZPc0prb2dpcFhmbVNhM3lWbVlReVl4OENIU3ZWa0NtUnNHUjZzWDdMTVRQSHhLRmtvcy8rODBSSms4MEpDeVFYMWcvRUNRVTZpeG5xcE9IM1EvT0MwVmZESXJBUkJqU3Z1T1FFZkVIVEpiTDJrUU5WMS95RWl3PT0tLTNIRWgxcG9tTVBtSjV2dHBPZVNuN2c9PQ%3D%3D--1c646bd30c43f940124d9a272a1c031357fb38c9; _artist_session=a0RjNmhWa2ViUWlJZVg4WlZpdG5DWXlvU0VpSCtVejFLWjRVWTUvdHloWWR0NXJoS2EydXpPWE16elYrZ1hMS0VlYVhReWxXWk5zaFloL25aNDJlb3BDN0NSV0R0NDRMV2pRdVRwWXBjOWFQc2htSkkxQ0hKalBJWTBBSWFLcHcrRWZ2TFVveCtnOWY2YkpRc3Rjd3RTVkcxclB6aW5BVEJsVGk1U2R6MXAwSUNQVElqNkVzbmJSMkNkWnYwVEM3bWtCeVJjeURpTmM0dDgwWXY4WGpSZDUrT3JKeXV1VVRlOXhRc3FDaE5YL2wxdnorbDZuMUFMRmVLMkEzS3kxMTdBRi9hSkZmMzgrclZodC8ySVpaaityVTkyeEVqWmd1QVA2YnJ5RmRiTUovcHpoZm9OMmFpYUZLZ1dtc1EzQXlWdVhqYnJqUEhwVGtiZVk3aTlQWDU2ZG5MQUJSWUR6R2cyWm9UTTBxcmhWRzhlRldYcW13RTB6aGY1TU4zdEtzOTBvODBjSTREVUE5eFZSRTYvK2VZaG5XejZTOWhZb1RCeUxKRXp0RVU2blFmMjk5M2VKSUJiallnMFVKMFhSQy0tbVYvSVRNa3pQaG1FRmNvcWhqQndTQT09--1c0a691c9fcf1139925891a03ba314cf1f377a47' -H 'Connection: keep-alive' --compressed
